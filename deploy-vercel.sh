#!/bin/bash

echo "üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ Vercel..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Vercel CLI
if ! command -v vercel &> /dev/null; then
    echo "‚ùå Vercel CLI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º..."
    npm install -g vercel
fi

# –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
echo "üì¶ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤..."
./deploy-static.sh

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É public –∏ –∫–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã
echo "üìÅ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è Vercel..."
mkdir -p public
cp dist/*.html dist/*.css dist/*.js public/ 2>/dev/null || true
cp -r dist/admin public/ 2>/dev/null || true

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ Vercel
echo "üîê –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ Vercel..."
if ! vercel whoami &> /dev/null; then
    echo "‚ùå –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Vercel. –í—ã–ø–æ–ª–Ω–∏—Ç–µ: vercel login"
    exit 1
fi

# –î–µ–ø–ª–æ–∏–º –Ω–∞ Vercel
echo "üåê –î–µ–ø–ª–æ–∏–º –Ω–∞ Vercel..."
vercel --prod --yes

echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
echo ""
echo "üîó –í–∞—à —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: https://online-school-three.vercel.app"
echo ""
echo "üìã –ù–µ –∑–∞–±—É–¥—å—Ç–µ:"
echo "1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü"
echo "2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å –∫–æ–¥–æ–º 1234"
echo "3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–¥–æ–±–∞–≤–∏—Ç—å SMS_API_ID –≤ Supabase)"
echo ""
echo "üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: https://vercel.com/dashboard"